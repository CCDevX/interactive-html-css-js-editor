(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();const d={themes:{dark:{"--vscode-bg":"#1e1e1e","--vscode-text":"#d4d4d4","--vscode-text-muted":"#888888","--vscode-sidebar":"#252526","--vscode-editor":"#1e1e1e","--vscode-tab":"#2d2d2d","--vscode-tab-active":"#1e1e1e","--vscode-border":"#3c3c3c","--vscode-hover":"#2a2d2e","--vscode-accent-blue":"#569cd6","--vscode-accent-green":"#4ec9b0","--vscode-accent-red":"#f44747","--vscode-accent-yellow":"#dcdcaa","--vscode-selection":"#264f78"},light:{"--vscode-bg":"#ffffff","--vscode-text":"#333333","--vscode-text-muted":"#6c757d","--vscode-sidebar":"#f3f3f3","--vscode-editor":"#ffffff","--vscode-tab":"#e7e7e7","--vscode-tab-active":"#ffffff","--vscode-border":"#d1d1d1","--vscode-hover":"#e2e2e2","--vscode-accent-blue":"#0066cc","--vscode-accent-green":"#2e8b57","--vscode-accent-red":"#cc0000","--vscode-accent-yellow":"#ffcc00","--vscode-selection":"#cce4ff"}},debounceDelay:300},h={html:["div","span","p","h1","h2","h3","h4","h5","h6","a","img","ul","ol","li","table","tr","td","th","form","input","button","textarea","select","option","header","footer","nav","section","article","aside","main","figure","figcaption","canvas","svg","video","audio",'class="','id="','src="','href="','alt="','title="','style="','onclick="','type="','name="','value="','placeholder="',"required","disabled","<!DOCTYPE html>",'<html lang="fr">',"<head>","</head>","<body>","</body>","</html>",'<meta charset="UTF-8">','<meta name="viewport" content="width=device-width, initial-scale=1.0">'],css:["color:","background:","background-color:","background-image:","width:","height:","margin:","padding:","border:","border-radius:","font-size:","font-family:","font-weight:","text-align:","display:","position:","top:","left:","right:","bottom:","flex:","flex-direction:","justify-content:","align-items:","grid:","grid-template-columns:","grid-template-rows:","transform:","transition:","animation:","opacity:","box-shadow:","text-shadow:","overflow:","z-index:","center","left","right","justify","flex","block","inline","inline-block","none","absolute","relative","fixed","sticky","row","column","wrap","nowrap","space-between","space-around","flex-start","flex-end","baseline","stretch","px","em","rem","%","vh","vw","fr","auto",":hover",":focus",":active",":before",":after","@media"],js:["function","const","let","var","if","else","for","while","document.getElementById(","document.querySelector(","addEventListener(","innerHTML","textContent","style.","console.log(","console.error(","forEach(","map(","filter(","length","push(","pop(","indexOf(","className","classList."]};class u{constructor(){this.suggestions=h,this.currentEditor=null,this.dropdownEl=null,this.currentSuggestions=[],this.selectedIndex=-1,this.isVisible=!1,this.init()}init(){this.createDropdown(),this.setupEditorListeners()}createDropdown(){this.dropdownEl=document.createElement("div"),this.dropdownEl.className="autocomplete-dropdown",document.body.appendChild(this.dropdownEl)}setupEditorListeners(){["html-code","css-code","js-code"].forEach(t=>{const n=document.getElementById(t);n&&(n.addEventListener("input",s=>this.handleInput(s)),n.addEventListener("keydown",s=>this.handleKeydown(s)),n.addEventListener("blur",()=>setTimeout(()=>this.hideDropdown(),100)),n.addEventListener("focus",s=>this.setCurrentEditor(s.target)))})}setCurrentEditor(e){this.currentEditor=e}handleInput(e){const t=e.target,n=t.selectionStart,s=t.value.substring(0,n),i=this.getEditorType(t),o=this.getCurrentWord(s);o.length>=1?this.showSuggestions(o,i,t,n):this.hideDropdown()}getEditorType(e){return e.id.includes("html")?"html":e.id.includes("css")?"css":e.id.includes("js")?"js":"html"}getCurrentWord(e){const t=e.match(/[\w-:.#@()]*$/);return t?t[0]:""}showSuggestions(e,t,n,s){const i=this.suggestions[t]||[];if(this.currentSuggestions=i.filter(o=>o.toLowerCase().includes(e.toLowerCase())).slice(0,8),this.currentSuggestions.length===0){this.hideDropdown();return}this.renderDropdown(e),this.positionDropdown(n,s),this.selectedIndex=-1,this.isVisible=!0}renderDropdown(e){this.dropdownEl.innerHTML="",this.currentSuggestions.forEach((t,n)=>{const s=document.createElement("div");s.className="autocomplete-item";const i=new RegExp(`(${e})`,"gi"),o=t.replace(i,'<mark style="background: var(--accent-primary); color: white; padding: 1px 2px; border-radius: 2px;">$1</mark>');s.innerHTML=o,s.addEventListener("mouseenter",()=>{this.selectedIndex=n,this.updateSelection()}),s.addEventListener("click",()=>{this.insertSuggestion(t,e)}),this.dropdownEl.appendChild(s)}),this.dropdownEl.style.display="block"}positionDropdown(e,t){const n=e.getBoundingClientRect(),s=20,i=e.value.substring(0,t).split(`
`),o=i.length-1,r=i[i.length-1].length,a=n.left+Math.min(r*9,300),c=n.top+o*s+s;this.dropdownEl.style.left=Math.min(a,window.innerWidth-220)+"px",this.dropdownEl.style.top=Math.min(c,window.innerHeight-200)+"px"}handleKeydown(e){if(this.isVisible)switch(e.key){case"ArrowDown":e.preventDefault(),this.selectedIndex=Math.min(this.selectedIndex+1,this.currentSuggestions.length-1),this.updateSelection();break;case"ArrowUp":e.preventDefault(),this.selectedIndex=Math.max(this.selectedIndex-1,-1),this.updateSelection();break;case"Enter":case"Tab":if(this.selectedIndex>=0){e.preventDefault();const t=this.currentSuggestions[this.selectedIndex],n=this.getCurrentWord(this.currentEditor.value.substring(0,this.currentEditor.selectionStart));this.insertSuggestion(t,n)}break;case"Escape":e.preventDefault(),this.hideDropdown();break}}updateSelection(){this.dropdownEl.querySelectorAll(".autocomplete-item").forEach((t,n)=>{n===this.selectedIndex?(t.style.background="var(--accent-primary)",t.style.borderLeftColor="var(--accent-primary)",t.style.color="white",t.scrollIntoView({block:"nearest"})):(t.style.background="transparent",t.style.borderLeftColor="transparent",t.style.color="var(--text-primary)")})}insertSuggestion(e,t){const n=this.currentEditor,s=n.selectionStart,i=n.value.substring(0,s-t.length),o=n.value.substring(s);n.value=i+e+o;const r=i.length+e.length;n.selectionStart=n.selectionEnd=r,this.hideDropdown(),n.focus(),n.dispatchEvent(new Event("input"))}hideDropdown(){this.dropdownEl.style.display="none",this.isVisible=!1,this.selectedIndex=-1,this.currentSuggestions=[]}}class m{constructor(e,t){this.editor=e,this.lineNumbersEl=t,this.isScrolling=!1,this.init()}init(){this.updateLineNumbers(),this.setupEventListeners()}setupEventListeners(){this.editor.addEventListener("input",()=>this.updateLineNumbers()),this.editor.addEventListener("scroll",()=>this.syncScroll()),window.addEventListener("resize",()=>this.updateLineNumbers())}updateLineNumbers(){const t=this.editor.value.split(`
`).length;let n="";for(let s=1;s<=t;s++)n+=s+`
`;n=n.slice(0,-1),this.lineNumbersEl.textContent=n,this.syncScroll()}syncScroll(){this.isScrolling||(this.isScrolling=!0,requestAnimationFrame(()=>{this.lineNumbersEl.scrollTop=this.editor.scrollTop,this.isScrolling=!1}))}}class g{constructor(){this.element=document.getElementById("console"),this.content=document.getElementById("console-content"),this.summary=document.getElementById("console-summary"),this.status=document.getElementById("console-status"),this.toggle=document.getElementById("console-toggle"),this.minimizeBtn=document.getElementById("minimize-console"),this.isExpanded=!1,this.errorCount=0,this.warningCount=0,this.setupToggle(),this.setupMinimize(),this.setupMessageListener()}setupToggle(){var e;(e=this.toggle)==null||e.addEventListener("click",()=>{this.isExpanded=!this.isExpanded,this.element.classList.toggle("expanded",this.isExpanded),this.isExpanded?(this.toggle.innerHTML='<i class="fas fa-chevron-down"></i> Réduire',this.minimizeBtn.style.display="flex"):(this.toggle.innerHTML='<i class="fas fa-chevron-up"></i> Détails',this.minimizeBtn.style.display="none")})}setupMinimize(){var e;(e=this.minimizeBtn)==null||e.addEventListener("click",()=>{this.isExpanded=!1,this.element.classList.remove("expanded"),this.toggle.innerHTML='<i class="fas fa-chevron-up"></i> Détails',this.minimizeBtn.style.display="none"})}setupMessageListener(){window.addEventListener("message",e=>{if(e.data&&e.data.type)switch(e.data.type){case"log":this.log(e.data.message,"info");break;case"error":this.error(e.data.message);break;case"warning":this.warn(e.data.message);break}})}updateStatus(){this.errorCount>0?(this.status.className="console-status error",this.status.innerHTML=`<i class="fas fa-exclamation-circle"></i><span>${this.errorCount} erreur(s)</span>`):this.warningCount>0?(this.status.className="console-status warning",this.status.innerHTML=`<i class="fas fa-exclamation-triangle"></i><span>${this.warningCount} warning(s)</span>`):(this.status.className="console-status success",this.status.innerHTML='<i class="fas fa-check-circle"></i><span>Aucune erreur</span>')}addMessage(e,t="info"){const n=new Date().toLocaleTimeString(),s=document.createElement("div");s.className=`console-message ${t}`,s.innerHTML=`
      <span class="timestamp">[${n}]</span>
      <span class="message">${e}</span>
    `,this.content.appendChild(s),this.content.scrollTop=this.content.scrollHeight,t==="error"?(this.errorCount++,this.showToast(e,"error")):t==="warning"&&(this.warningCount++,this.showToast(e,"warning")),this.updateStatus()}showToast(e,t){const n=document.getElementById("toast-container");if(!n)return;const s=document.createElement("div");s.className=`toast ${t}`,s.innerHTML=`
      <i class="fas fa-${t==="error"?"exclamation-circle":"exclamation-triangle"}"></i>
      <span>${e.substring(0,50)}${e.length>50?"...":""}</span>
      <button class="close-btn"><i class="fas fa-times"></i></button>
    `,s.querySelector(".close-btn").addEventListener("click",()=>{s.classList.remove("show"),setTimeout(()=>n.removeChild(s),300)}),n.appendChild(s),setTimeout(()=>s.classList.add("show"),10),setTimeout(()=>{s.parentNode&&(s.classList.remove("show"),setTimeout(()=>{s.parentNode&&n.removeChild(s)},300))},5e3)}log(e,t="info"){this.addMessage(e,t)}error(e){this.addMessage(e,"error")}warn(e){this.addMessage(e,"warning")}clear(){this.content.innerHTML=`
      <div class="console-message info">
        <span class="timestamp">[${new Date().toLocaleTimeString()}]</span>
        <span class="message">Console effacée</span>
      </div>
    `,this.errorCount=0,this.warningCount=0,this.updateStatus()}}class p{constructor(){this.editors={html:document.getElementById("html-code"),css:document.getElementById("css-code"),js:document.getElementById("js-code")},this.lineNumbers={},this.output=document.getElementById("output"),this.console=new g,this.currentTheme="dark",this.isResizing=!1,this.debounceTimer=null,this.init()}init(){this.setupEventListeners(),this.initializeLineNumbers(),this.loadFromStorage(),this.setupResizer(),this.initAutoComplete(),this.run()}initAutoComplete(){setTimeout(()=>{this.autoComplete=new u},100)}setupEventListeners(){var e,t,n,s,i,o;Object.values(this.editors).forEach(r=>{r.addEventListener("input",()=>this.debouncedRun()),r.addEventListener("keydown",a=>this.handleKeyDown(a))}),(e=document.getElementById("run-btn"))==null||e.addEventListener("click",()=>this.run()),(t=document.getElementById("reset-btn"))==null||t.addEventListener("click",()=>this.reset()),(n=document.getElementById("theme-toggle"))==null||n.addEventListener("click",()=>this.toggleTheme()),(s=document.getElementById("refresh-output"))==null||s.addEventListener("click",()=>this.run()),(i=document.getElementById("fullscreen-btn"))==null||i.addEventListener("click",()=>this.toggleFullscreen()),(o=document.getElementById("clear-console"))==null||o.addEventListener("click",()=>this.console.clear()),this.setupDownloadButtons(),window.addEventListener("beforeunload",()=>this.saveToStorage())}setupDownloadButtons(){var n,s;const e=document.getElementById("download-dropdown"),t=document.getElementById("download-menu");(n=document.getElementById("download-btn"))==null||n.addEventListener("click",()=>this.downloadAll()),e==null||e.addEventListener("click",i=>{i.stopPropagation(),t==null||t.classList.toggle("show")}),document.addEventListener("click",()=>t==null?void 0:t.classList.remove("show")),["html","css","js"].forEach(i=>{var o;(o=document.getElementById(`download-${i}`))==null||o.addEventListener("click",()=>this.downloadFile(i))}),(s=document.getElementById("download-all"))==null||s.addEventListener("click",()=>this.downloadAll())}downloadFile(e){var i;let t=this.editors[e].value;const n={html:"html",css:"css",js:"js"},s={html:"text/html",css:"text/css",js:"application/javascript"};if(!t.trim()){this.console.warn(`Le fichier ${e.toUpperCase()} est vide`);return}e==="html"&&(t=`<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
${t}
</body>
</html>`),this.createDownload(t,`index.${n[e]}`,s[e]),this.console.log(`Fichier ${e.toUpperCase()} téléchargé`,"info"),(i=document.getElementById("download-menu"))==null||i.classList.remove("show")}downloadAll(){var o;const e=this.editors.html.value,t=this.editors.css.value,n=this.editors.js.value,s=new JSZip;s.file("style.css",t),s.file("script.js",n);const i=`<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Projet exporté</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  ${e}
  <script src="script.js"><\/script>
</body>
</html>`;s.file("index.html",i),s.generateAsync({type:"blob"}).then(r=>{saveAs(r,"mon-projet.zip"),this.console.log("Projet complet exporté en .zip","info")}),(o=document.getElementById("download-menu"))==null||o.classList.remove("show")}createDownload(e,t,n){const s=new Blob([e],{type:n}),i=URL.createObjectURL(s),o=document.createElement("a");o.href=i,o.download=t,o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o),setTimeout(()=>URL.revokeObjectURL(i),1e3)}debouncedRun(){clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>this.run(),d.debounceDelay)}run(){try{this.showLoading(!0);const e=this.buildFullHTML(this.editors.html.value,this.editors.css.value,this.editors.js.value);this.updateOutput(e),this.console.log("Code exécuté avec succès","info"),this.saveToStorage()}catch(e){this.console.error(`Erreur d'exécution: ${e.message}`)}finally{setTimeout(()=>this.showLoading(!1),300)}}buildFullHTML(e,t,n){return`
<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Aperçu Live Code Editor</title>
<style>body{margin:0;padding:20px;font-family:sans-serif;}${t}</style>
<script>
window.onerror = function(msg,url,line,col,error){
  try{window.parent.postMessage({type:'error',message:msg,line:line,column:col},'*');}catch(e){}
  return false;
};
(function(){
  const original = { log: console.log, error: console.error, warn: console.warn };
  console.log = function(...args){try{window.parent.postMessage({type:'log',message:args.join(' ')},'*');}catch(e){}original.log(...args);};
  console.error = function(...args){try{window.parent.postMessage({type:'error',message:args.join(' ')},'*');}catch(e){}original.error(...args);};
  console.warn = function(...args){try{window.parent.postMessage({type:'warning',message:args.join(' ')},'*');}catch(e){}original.warn(...args);};
})();
<\/script>
</head>
<body>
${e}
<script>try{${n}}catch(e){console.error('Erreur JavaScript:',e.message);}<\/script>
</body>
</html>`}updateOutput(e){this.output.src="data:text/html;charset=utf-8,"+encodeURIComponent(e)}initializeLineNumbers(){Object.entries(this.editors).forEach(([e,t])=>{const n=document.getElementById(`${e}-lines`);n&&(this.lineNumbers[e]=new m(t,n))})}handleKeyDown(e){if(e.ctrlKey&&e.key==="s"&&(e.preventDefault(),this.saveToStorage(),this.console.log("Code sauvegardé","info")),e.ctrlKey&&e.key==="Enter"&&(e.preventDefault(),this.run()),e.key==="Tab"){e.preventDefault();const t=e.target.selectionStart,n=e.target.selectionEnd;e.target.value=e.target.value.substring(0,t)+"    "+e.target.value.substring(n),e.target.selectionStart=e.target.selectionEnd=t+4}}showLoading(e){const t=document.getElementById("loading");t&&t.classList.toggle("show",e)}reset(){confirm("Êtes-vous sûr de vouloir effacer tout le code ?")&&(Object.values(this.editors).forEach(e=>e.value=""),Object.values(this.lineNumbers).forEach(e=>e.updateLineNumbers()),this.run(),this.console.clear(),this.console.log("Éditeurs réinitialisés","info"))}toggleTheme(){this.currentTheme=this.currentTheme==="dark"?"light":"dark",this.applyTheme(this.currentTheme),localStorage.setItem("editorTheme",this.currentTheme)}applyTheme(e){const t=document.documentElement,n=d.themes[e];Object.entries(n).forEach(([s,i])=>{t.style.setProperty(s,i)})}toggleFullscreen(){const e=document.querySelector(".right-panel");e.classList.toggle("fullscreen"),e.classList.contains("fullscreen")?Object.assign(e.style,{position:"fixed",top:"0",left:"0",width:"100vw",height:"100vh",zIndex:"9999"}):Object.assign(e.style,{position:"",top:"",left:"",width:"",height:"",zIndex:""})}saveToStorage(){const e={html:this.editors.html.value,css:this.editors.css.value,js:this.editors.js.value,theme:this.currentTheme};localStorage.setItem("liveCodeEditor",JSON.stringify(e))}loadFromStorage(){const e=localStorage.getItem("liveCodeEditor");if(e)try{const t=JSON.parse(e);this.editors.html.value=t.html||"",this.editors.css.value=t.css||"",this.editors.js.value=t.js||"",t.theme&&(this.currentTheme=t.theme,this.applyTheme(this.currentTheme))}catch(t){console.error("Erreur lors du chargement:",t)}}setupResizer(){const e=document.getElementById("resizer"),t=document.querySelector(".left-panel"),n=document.querySelector(".right-panel");!e||!t||!n||e.addEventListener("mousedown",s=>{this.isResizing=!0,document.body.style.cursor="col-resize",document.body.style.userSelect="none";const i=r=>{if(!this.isResizing)return;const a=document.querySelector(".container").clientWidth,c=r.clientX/a*100;c>20&&c<80&&(t.style.flex=`0 0 ${c}%`,n.style.flex=`0 0 ${100-c}%`)},o=()=>{this.isResizing=!1,document.body.style.cursor="",document.body.style.userSelect="",document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",o)};document.addEventListener("mousemove",i),document.addEventListener("mouseup",o)})}}document.addEventListener("DOMContentLoaded",()=>{const l=new p;l.console.log("Éditeur prêt - Commencez à coder !"),window.run=()=>l.run(),window.codeEditor=l,document.addEventListener("keydown",e=>{var t;e.key==="F12"&&(e.preventDefault(),(t=l.console.toggle)==null||t.click())}),console.log("Live Code Editor Pro initialisé avec succès!")});
